**å­¦ä¹ Ginæ¡†æ¶çš„å‚æ•°éªŒè¯å…ˆäº†è§£ä¸€ä¸‹[validatoråº“](https://github.com/go-playground/validator)**

**ginæ¡†æ¶æ˜¯ä½¿ç”¨validator.v10è¿™ä¸ªåº“æ¥è¿›è¡Œå‚æ•°éªŒè¯çš„ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹è¿™ä¸ªåº“çš„ä½¿ç”¨ã€‚**

[èµ„æ–™æ¥æº](https://segmentfault.com/a/1190000023725115)

### ç„¶åå…ˆå†™ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š

```go
package main

import (
    "fmt"

    "github.com/go-playground/validator/v10"
)

type User struct {
    Username string `validate:"min=6,max=10"`
    Age      uint8  `validate:"gte=1,lte=10"`
    Sex      string `validate:"oneof=female male"`
}

func main() {
    validate := validator.New()

    user1 := User{Username: "asong", Age: 11, Sex: "null"}
    err := validate.Struct(user1)
    if err != nil {
        fmt.Println(err)
    }

    user2 := User{Username: "asong111", Age: 8, Sex: "male"}
    err = validate.Struct(user2)
    if err != nil {
        fmt.Println(err)
    }

}
```

æˆ‘ä»¬åœ¨ç»“æ„ä½“å®šä¹‰validatoræ ‡ç­¾çš„tagï¼Œä½¿ç”¨`validator.New()`åˆ›å»ºä¸€ä¸ªéªŒè¯å™¨ï¼Œè¿™ä¸ªéªŒè¯å™¨å¯ä»¥æŒ‡å®šé€‰é¡¹ã€æ·»åŠ è‡ªå®šä¹‰çº¦æŸï¼Œç„¶ååœ¨è°ƒç”¨ä»–çš„`Struct()`æ–¹æ³•æ¥éªŒè¯å„ç§ç»“æ„å¯¹è±¡çš„å­—æ®µæ˜¯å¦ç¬¦åˆå®šä¹‰çš„çº¦æŸã€‚

ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬åœ¨Userç»“æ„ä½“ä¸­ï¼Œæœ‰ä¸‰ä¸ªå­—æ®µï¼š

- Nameï¼šé€šè¿‡minå’Œmaxæ¥è¿›è¡Œçº¦æŸï¼ŒNameçš„å­—ç¬¦ä¸²é•¿åº¦ä¸º[6,10]ä¹‹é—´ã€‚
- Ageï¼šé€šè¿‡gteå’Œlteå¯¹å¹´è½»çš„èŒƒå›´è¿›è¡Œçº¦æŸï¼Œageçš„å¤§å°å¤§äº1ï¼Œå°äº10ã€‚
- Sexï¼šé€šè¿‡oneofå¯¹å€¼è¿›è¡Œçº¦æŸï¼Œåªèƒ½æ˜¯æ‰€åˆ—ä¸¾çš„å€¼ï¼Œoneofåˆ—ä¸¾å‡ºæ€§åˆ«ä¸ºç”·å£«ğŸš¹å’Œå¥³å£«ğŸšº(ä¸æ˜¯ç¡¬æ€§è§„å®šå¥¥ï¼Œå¯èƒ½è¿˜æœ‰åˆ«çš„æ€§åˆ«)ã€‚

æ‰€ä»¥`user1`ä¼šè¿›è¡ŒæŠ¥é”™ï¼Œé”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š

```
Key: 'User.Name' Error:Field validation for 'Name' failed on the 'min' tag
Key: 'User.Age' Error:Field validation for 'Age' failed on the 'lte' tag
Key: 'User.Sex' Error:Field validation for 'Sex' failed on the 'oneof' tag
```

### ä¸€äº›çº¦æŸ

#### å­—ç¬¦ä¸²çº¦æŸ

* `excludesall`ï¼šä¸åŒ…å«å‚æ•°ä¸­ä»»æ„çš„ UNICODE å­—ç¬¦ï¼Œä¾‹å¦‚`excludesall=ab`ï¼›
* `excludesrune`ï¼šä¸åŒ…å«å‚æ•°è¡¨ç¤ºçš„ rune å­—ç¬¦ï¼Œ`excludesrune=asong`ï¼›
* `startswith`ï¼šä»¥å‚æ•°å­ä¸²ä¸ºå‰ç¼€ï¼Œä¾‹å¦‚`startswith=hi`ï¼›
* `endswith`ï¼šä»¥å‚æ•°å­ä¸²ä¸ºåç¼€ï¼Œä¾‹å¦‚`endswith=bye`ã€‚
* `contains=`ï¼šåŒ…å«å‚æ•°å­ä¸²ï¼Œä¾‹å¦‚`contains=email`ï¼›
* `containsany`ï¼šåŒ…å«å‚æ•°ä¸­ä»»æ„çš„ UNICODE å­—ç¬¦ï¼Œä¾‹å¦‚`containsany=ab`ï¼›
* `containsrune`ï¼šåŒ…å«å‚æ•°è¡¨ç¤ºçš„ rune å­—ç¬¦ï¼Œä¾‹å¦‚`containsrune=asongï¼›
* `excludes`ï¼šä¸åŒ…å«å‚æ•°å­ä¸²ï¼Œä¾‹å¦‚`excludes=email`ï¼›

#### èŒƒå›´çº¦æŸ

èŒƒå›´çº¦æŸçš„å­—æ®µç±»å‹åˆ†ä¸ºä¸‰ç§ï¼š

- å¯¹äºæ•°å€¼ï¼Œæˆ‘ä»¬åˆ™å¯ä»¥çº¦æŸå…¶å€¼
- å¯¹äºåˆ‡ç‰‡ã€æ•°ç»„å’Œmapï¼Œæˆ‘ä»¬åˆ™å¯ä»¥çº¦æŸå…¶é•¿åº¦
- å¯¹äºå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬åˆ™å¯ä»¥çº¦æŸå…¶é•¿åº¦

å¸¸ç”¨tagä»‹ç»ï¼š

- `ne`ï¼šä¸ç­‰äºå‚æ•°å€¼ï¼Œä¾‹å¦‚`ne=5`ï¼›
- `gt`ï¼šå¤§äºå‚æ•°å€¼ï¼Œä¾‹å¦‚`gt=5`ï¼›
- `gte`ï¼šå¤§äºç­‰äºå‚æ•°å€¼ï¼Œä¾‹å¦‚`gte=50`ï¼›
- `lt`ï¼šå°äºå‚æ•°å€¼ï¼Œä¾‹å¦‚`lt=50`ï¼›
- `lte`ï¼šå°äºç­‰äºå‚æ•°å€¼ï¼Œä¾‹å¦‚`lte=50`ï¼›
- `oneof`ï¼šåªèƒ½æ˜¯åˆ—ä¸¾å‡ºçš„å€¼å…¶ä¸­ä¸€ä¸ªï¼Œè¿™äº›å€¼å¿…é¡»æ˜¯æ•°å€¼æˆ–å­—ç¬¦ä¸²ï¼Œä»¥ç©ºæ ¼åˆ†éš”ï¼Œå¦‚æœå­—ç¬¦ä¸²ä¸­æœ‰ç©ºæ ¼ï¼Œå°†å­—ç¬¦ä¸²ç”¨å•å¼•å·åŒ…å›´ï¼Œä¾‹å¦‚`oneof=male female`ã€‚
- `eq`ï¼šç­‰äºå‚æ•°å€¼ï¼Œæ³¨æ„ä¸`len`ä¸åŒã€‚å¯¹äºå­—ç¬¦ä¸²ï¼Œ`eq`çº¦æŸå­—ç¬¦ä¸²æœ¬èº«çš„å€¼ï¼Œè€Œ`len`çº¦æŸå­—ç¬¦ä¸²é•¿åº¦ã€‚ä¾‹å¦‚`eq=10`ï¼›
- `len`ï¼šç­‰äºå‚æ•°å€¼ï¼Œä¾‹å¦‚`len=10`ï¼›
- `max`ï¼šå°äºç­‰äºå‚æ•°å€¼ï¼Œä¾‹å¦‚`max=10`ï¼›
- `min`ï¼šå¤§äºç­‰äºå‚æ•°å€¼ï¼Œä¾‹å¦‚`min=10`

#### Fieldsçº¦æŸ

- `eqfield`ï¼šå®šä¹‰å­—æ®µé—´çš„ç›¸ç­‰çº¦æŸï¼Œç”¨äºçº¦æŸåŒä¸€ç»“æ„ä½“ä¸­çš„å­—æ®µã€‚ä¾‹å¦‚ï¼š`eqfield=Password`
- `eqcsfield`ï¼šçº¦æŸç»Ÿä¸€ç»“æ„ä½“ä¸­å­—æ®µç­‰äºå¦ä¸€ä¸ªå­—æ®µï¼ˆç›¸å¯¹ï¼‰ï¼Œç¡®è®¤å¯†ç æ—¶å¯ä»¥ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š`eqfiel=ConfirmPassword`
- `nefield`ï¼šç”¨æ¥çº¦æŸä¸¤ä¸ªå­—æ®µæ˜¯å¦ç›¸åŒï¼Œç¡®è®¤ä¸¤ç§é¢œè‰²æ˜¯å¦ä¸€è‡´æ—¶å¯ä»¥ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š`nefield=Color1`
- `necsfield`ï¼šçº¦æŸä¸¤ä¸ªå­—æ®µæ˜¯å¦ç›¸åŒï¼ˆç›¸å¯¹ï¼‰

#### å¸¸ç”¨çº¦æŸ

- `unique`ï¼šæŒ‡å®šå”¯ä¸€æ€§çº¦æŸï¼Œä¸åŒç±»å‹å¤„ç†ä¸åŒï¼š
  - å¯¹äºmapï¼Œuniqueçº¦æŸæ²¡æœ‰é‡å¤çš„å€¼
  - å¯¹äºæ•°ç»„å’Œåˆ‡ç‰‡ï¼Œuniqueæ²¡æœ‰é‡å¤çš„å€¼
  - å¯¹äºå…ƒç´ ç±»å‹ä¸ºç»“æ„ä½“çš„ç¢ç‰‡ï¼Œuniqueçº¦æŸç»“æ„ä½“å¯¹è±¡çš„æŸä¸ªå­—æ®µä¸é‡å¤ï¼Œä½¿ç”¨`unique=field`æŒ‡å®šå­—æ®µå
- `email`ï¼šä½¿ç”¨`email`æ¥é™åˆ¶å­—æ®µå¿…é¡»æ˜¯é‚®ä»¶å½¢å¼ï¼Œç›´æ¥å†™`eamil`å³å¯ï¼Œæ— éœ€åŠ ä»»ä½•æŒ‡å®šã€‚
- `omitempty`ï¼šå­—æ®µæœªè®¾ç½®ï¼Œåˆ™å¿½ç•¥
- `-`ï¼šè·³è¿‡è¯¥å­—æ®µï¼Œä¸æ£€éªŒï¼›
- `|`ï¼šä½¿ç”¨å¤šä¸ªçº¦æŸï¼Œåªéœ€è¦æ»¡è¶³å…¶ä¸­ä¸€ä¸ªï¼Œä¾‹å¦‚`rgb|rgba`ï¼›
- `required`ï¼šå­—æ®µå¿…é¡»è®¾ç½®ï¼Œä¸èƒ½ä¸ºé»˜è®¤å€¼ï¼›